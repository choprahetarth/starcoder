Running "module reset". Resetting modules to system default. The following $MODULEPATH directories have been removed: None
WARNING:__main__:
*****************************************
Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
*****************************************
starting...
starting...
starting...
starting...
Loading PEFT model...
Loading PEFT model...
Loading PEFT model...
Loading PEFT model...
Merging and unloading model...
Merging and unloading model...
Merging and unloading model...
Merging and unloading model...
Loading tokenizer...
Loading tokenizer...
Loading tokenizer...
Loading tokenizer...
Saving pretrained model and tokenizer...
Saving pretrained model and tokenizer...
Saving pretrained model and tokenizer...
Saving pretrained model and tokenizer...
Loading model for causal language modeling...
Loading model for causal language modeling...
Loading model for causal language modeling...
Loading model for causal language modeling...
Time taken to load model:  2.693225383758545
Model saved to //projects/bbvz/choprahetarth/new_experiments/experiment_1/final_checkpoint_starcoderbase-1b_lr_0.0001_bs_64_ms_54_dp_/u/choprahetarth/all_files/data/train_ftdata-new-small.json-merged
Loading dataset...
Time taken to load model:  2.7838988304138184
Model saved to //projects/bbvz/choprahetarth/new_experiments/experiment_1/final_checkpoint_starcoderbase-1b_lr_0.0001_bs_64_ms_54_dp_/u/choprahetarth/all_files/data/train_ftdata-new-small.json-merged
Loading dataset...
Time taken to load model:  2.5431625843048096
Model saved to //projects/bbvz/choprahetarth/new_experiments/experiment_1/final_checkpoint_starcoderbase-1b_lr_0.0001_bs_64_ms_54_dp_/u/choprahetarth/all_files/data/train_ftdata-new-small.json-merged
Loading dataset...
Dataset loaded and shuffled successfully.
Dataset loaded and shuffled successfully.
Dataset loaded and shuffled successfully.
Time taken to load model:  2.4978718757629395
Model saved to //projects/bbvz/choprahetarth/new_experiments/experiment_1/final_checkpoint_starcoderbase-1b_lr_0.0001_bs_64_ms_54_dp_/u/choprahetarth/all_files/data/train_ftdata-new-small.json-merged
Loading dataset...
Dataset loaded and shuffled successfully.

  0%|          | 0/29 [00:00<?, ?it/s]
  0%|          | 0/29 [00:00<?, ?it/s]
  0%|          | 0/29 [00:00<?, ?it/s]
  0%|          | 0/29 [00:00<?, ?it/s]/u/choprahetarth/.conda/envs/scoder_2_py10/lib/python3.10/site-packages/nltk/translate/bleu_score.py:552: UserWarning: 
The hypothesis contains 0 counts of 4-gram overlaps.
Therefore the BLEU score evaluates to 0, independently of
how many N-gram overlaps of lower order it contains.
Consider using lower n-gram order or use SmoothingFunction()
  warnings.warn(_msg)
/u/choprahetarth/.conda/envs/scoder_2_py10/lib/python3.10/site-packages/nltk/translate/bleu_score.py:552: UserWarning: 
The hypothesis contains 0 counts of 4-gram overlaps.
Therefore the BLEU score evaluates to 0, independently of
how many N-gram overlaps of lower order it contains.
Consider using lower n-gram order or use SmoothingFunction()
  warnings.warn(_msg)
/u/choprahetarth/.conda/envs/scoder_2_py10/lib/python3.10/site-packages/nltk/translate/bleu_score.py:552: UserWarning: 
The hypothesis contains 0 counts of 4-gram overlaps.
Therefore the BLEU score evaluates to 0, independently of
how many N-gram overlaps of lower order it contains.
Consider using lower n-gram order or use SmoothingFunction()
  warnings.warn(_msg)
/u/choprahetarth/.conda/envs/scoder_2_py10/lib/python3.10/site-packages/nltk/translate/bleu_score.py:552: UserWarning: 
The hypothesis contains 0 counts of 4-gram overlaps.
Therefore the BLEU score evaluates to 0, independently of
how many N-gram overlaps of lower order it contains.
Consider using lower n-gram order or use SmoothingFunction()
  warnings.warn(_msg)

  3%|▎         | 1/29 [03:06<1:26:51, 186.13s/it]
  3%|▎         | 1/29 [03:06<1:26:53, 186.21s/it]
  3%|▎         | 1/29 [03:05<1:26:39, 185.71s/it]
  3%|▎         | 1/29 [03:06<1:26:54, 186.22s/it]
  7%|▋         | 2/29 [04:36<58:25, 129.84s/it]  
  7%|▋         | 2/29 [04:36<58:20, 129.63s/it]  
  7%|▋         | 2/29 [04:36<58:25, 129.82s/it]  
  7%|▋         | 2/29 [04:36<58:26, 129.87s/it]  
 10%|█         | 3/29 [06:41<55:15, 127.51s/it]
 10%|█         | 3/29 [06:41<55:16, 127.55s/it]
 10%|█         | 3/29 [06:40<55:14, 127.47s/it]
 10%|█         | 3/29 [06:41<55:17, 127.59s/it]
 14%|█▍        | 4/29 [09:44<1:02:14, 149.36s/it]
 14%|█▍        | 4/29 [09:44<1:02:15, 149.43s/it]
 14%|█▍        | 4/29 [09:44<1:02:15, 149.43s/it]
 14%|█▍        | 4/29 [09:44<1:02:17, 149.50s/it]/u/choprahetarth/.conda/envs/scoder_2_py10/lib/python3.10/site-packages/nltk/translate/bleu_score.py:552: UserWarning: 
The hypothesis contains 0 counts of 3-gram overlaps.
Therefore the BLEU score evaluates to 0, independently of
how many N-gram overlaps of lower order it contains.
Consider using lower n-gram order or use SmoothingFunction()
  warnings.warn(_msg)

 17%|█▋        | 5/29 [11:22<52:25, 131.07s/it]  /u/choprahetarth/.conda/envs/scoder_2_py10/lib/python3.10/site-packages/nltk/translate/bleu_score.py:552: UserWarning: 
The hypothesis contains 0 counts of 3-gram overlaps.
Therefore the BLEU score evaluates to 0, independently of
how many N-gram overlaps of lower order it contains.
Consider using lower n-gram order or use SmoothingFunction()
  warnings.warn(_msg)
/u/choprahetarth/.conda/envs/scoder_2_py10/lib/python3.10/site-packages/nltk/translate/bleu_score.py:552: UserWarning: 
The hypothesis contains 0 counts of 3-gram overlaps.
Therefore the BLEU score evaluates to 0, independently of
how many N-gram overlaps of lower order it contains.
Consider using lower n-gram order or use SmoothingFunction()
  warnings.warn(_msg)
/u/choprahetarth/.conda/envs/scoder_2_py10/lib/python3.10/site-packages/nltk/translate/bleu_score.py:552: UserWarning: 
The hypothesis contains 0 counts of 3-gram overlaps.
Therefore the BLEU score evaluates to 0, independently of
how many N-gram overlaps of lower order it contains.
Consider using lower n-gram order or use SmoothingFunction()
  warnings.warn(_msg)

 17%|█▋        | 5/29 [11:23<52:30, 131.26s/it]  
 17%|█▋        | 5/29 [11:23<52:32, 131.34s/it]  
 17%|█▋        | 5/29 [11:23<52:31, 131.31s/it]  
 21%|██        | 6/29 [13:55<53:00, 138.30s/it]
 21%|██        | 6/29 [13:56<53:10, 138.70s/it]
 21%|██        | 6/29 [13:56<53:12, 138.80s/it]
 21%|██        | 6/29 [13:57<53:13, 138.83s/it]
 24%|██▍       | 7/29 [16:42<54:10, 147.76s/it]
 24%|██▍       | 7/29 [16:46<54:34, 148.84s/it]
 24%|██▍       | 7/29 [16:47<54:40, 149.09s/it]
 24%|██▍       | 7/29 [16:46<54:39, 149.09s/it]
 28%|██▊       | 8/29 [18:50<49:32, 141.54s/it]
 28%|██▊       | 8/29 [18:55<49:53, 142.55s/it]
 28%|██▊       | 8/29 [18:57<50:05, 143.13s/it]
 28%|██▊       | 8/29 [18:57<50:05, 143.14s/it]
 31%|███       | 9/29 [21:53<51:26, 154.34s/it]
 31%|███       | 9/29 [21:59<51:48, 155.44s/it]
 31%|███       | 9/29 [22:02<52:06, 156.30s/it]
 31%|███       | 9/29 [22:02<52:06, 156.32s/it]
 34%|███▍      | 10/29 [24:19<48:08, 152.03s/it]
 34%|███▍      | 10/29 [24:24<48:13, 152.31s/it]
 34%|███▍      | 10/29 [24:29<48:31, 153.26s/it]
 34%|███▍      | 10/29 [24:28<48:31, 153.25s/it]
 38%|███▊      | 11/29 [26:45<44:58, 149.90s/it]
 38%|███▊      | 11/29 [26:49<45:01, 150.09s/it]
 38%|███▊      | 11/29 [26:54<45:16, 150.93s/it]
 38%|███▊      | 11/29 [26:55<45:16, 150.94s/it]
 41%|████▏     | 12/29 [29:10<42:06, 148.65s/it]
 41%|████▏     | 12/29 [29:15<42:08, 148.74s/it]
 41%|████▏     | 12/29 [29:20<42:20, 149.44s/it]
 41%|████▏     | 12/29 [29:21<42:21, 149.47s/it]Warning: Empty reference sentence detected; setting precision and recall to be 0.
Warning: Empty reference sentence detected; setting precision and recall to be 0.
Warning: Empty reference sentence detected; setting precision and recall to be 0.
/u/choprahetarth/.conda/envs/scoder_2_py10/lib/python3.10/site-packages/nltk/translate/bleu_score.py:552: UserWarning: 
The hypothesis contains 0 counts of 2-gram overlaps.
Therefore the BLEU score evaluates to 0, independently of
how many N-gram overlaps of lower order it contains.
Consider using lower n-gram order or use SmoothingFunction()
  warnings.warn(_msg)

 45%|████▍     | 13/29 [31:52<40:41, 152.62s/it]Warning: Empty reference sentence detected; setting precision and recall to be 0.
Warning: Empty reference sentence detected; setting precision and recall to be 0.
Warning: Empty reference sentence detected; setting precision and recall to be 0.
/u/choprahetarth/.conda/envs/scoder_2_py10/lib/python3.10/site-packages/nltk/translate/bleu_score.py:552: UserWarning: 
The hypothesis contains 0 counts of 2-gram overlaps.
Therefore the BLEU score evaluates to 0, independently of
how many N-gram overlaps of lower order it contains.
Consider using lower n-gram order or use SmoothingFunction()
  warnings.warn(_msg)

 45%|████▍     | 13/29 [31:56<40:42, 152.66s/it]Warning: Empty reference sentence detected; setting precision and recall to be 0.
Warning: Empty reference sentence detected; setting precision and recall to be 0.
Warning: Empty reference sentence detected; setting precision and recall to be 0.
Warning: Empty reference sentence detected; setting precision and recall to be 0.
Warning: Empty reference sentence detected; setting precision and recall to be 0.
Warning: Empty reference sentence detected; setting precision and recall to be 0.
/u/choprahetarth/.conda/envs/scoder_2_py10/lib/python3.10/site-packages/nltk/translate/bleu_score.py:552: UserWarning: 
The hypothesis contains 0 counts of 2-gram overlaps.
Therefore the BLEU score evaluates to 0, independently of
how many N-gram overlaps of lower order it contains.
Consider using lower n-gram order or use SmoothingFunction()
  warnings.warn(_msg)
/u/choprahetarth/.conda/envs/scoder_2_py10/lib/python3.10/site-packages/nltk/translate/bleu_score.py:552: UserWarning: 
The hypothesis contains 0 counts of 2-gram overlaps.
Therefore the BLEU score evaluates to 0, independently of
how many N-gram overlaps of lower order it contains.
Consider using lower n-gram order or use SmoothingFunction()
  warnings.warn(_msg)

 45%|████▍     | 13/29 [32:03<40:53, 153.33s/it]
 45%|████▍     | 13/29 [32:02<40:53, 153.34s/it]
 48%|████▊     | 14/29 [33:38<34:37, 138.52s/it]
 48%|████▊     | 14/29 [33:42<34:36, 138.40s/it]
 48%|████▊     | 14/29 [33:48<34:41, 138.76s/it]
 48%|████▊     | 14/29 [33:48<34:41, 138.77s/it]
 52%|█████▏    | 15/29 [35:31<30:29, 130.71s/it]
 52%|█████▏    | 15/29 [35:35<30:29, 130.67s/it]
 52%|█████▏    | 15/29 [35:41<30:35, 131.11s/it]
 52%|█████▏    | 15/29 [35:41<30:35, 131.13s/it]
 55%|█████▌    | 16/29 [38:35<31:49, 146.91s/it]
 55%|█████▌    | 16/29 [38:39<31:51, 147.00s/it]
 55%|█████▌    | 16/29 [38:48<32:00, 147.72s/it]
 55%|█████▌    | 16/29 [38:47<32:00, 147.72s/it]
 59%|█████▊    | 17/29 [40:11<26:17, 131.48s/it]
 59%|█████▊    | 17/29 [40:15<26:16, 131.39s/it]
 59%|█████▊    | 17/29 [40:22<26:18, 131.56s/it]
 59%|█████▊    | 17/29 [40:21<26:19, 131.59s/it]
 62%|██████▏   | 18/29 [42:18<23:51, 130.14s/it]
 62%|██████▏   | 18/29 [42:22<23:51, 130.18s/it]
 62%|██████▏   | 18/29 [42:30<23:55, 130.51s/it]
 62%|██████▏   | 18/29 [42:29<23:56, 130.56s/it]
 66%|██████▌   | 19/29 [45:00<23:19, 139.91s/it]
 66%|██████▌   | 19/29 [45:05<23:19, 139.96s/it]
 66%|██████▌   | 19/29 [45:13<23:23, 140.37s/it]
 66%|██████▌   | 19/29 [45:13<23:24, 140.40s/it]
 69%|██████▉   | 20/29 [47:35<21:38, 144.33s/it]
 69%|██████▉   | 20/29 [47:39<21:39, 144.38s/it]
 69%|██████▉   | 20/29 [47:48<21:43, 144.83s/it]
 69%|██████▉   | 20/29 [47:48<21:43, 144.84s/it]
 72%|███████▏  | 21/29 [49:46<18:42, 140.30s/it]
 72%|███████▏  | 21/29 [49:50<18:42, 140.28s/it]
 72%|███████▏  | 21/29 [49:59<18:43, 140.46s/it]
 72%|███████▏  | 21/29 [49:58<18:44, 140.51s/it]
 76%|███████▌  | 22/29 [51:43<15:33, 133.38s/it]
 76%|███████▌  | 22/29 [51:47<15:33, 133.31s/it]
 76%|███████▌  | 22/29 [51:56<15:34, 133.48s/it]
 76%|███████▌  | 22/29 [51:55<15:34, 133.49s/it]
 79%|███████▉  | 23/29 [54:14<13:52, 138.70s/it]
 79%|███████▉  | 23/29 [54:19<13:52, 138.73s/it]
 79%|███████▉  | 23/29 [54:29<13:55, 139.30s/it]
 79%|███████▉  | 23/29 [54:28<13:55, 139.32s/it]
 83%|████████▎ | 24/29 [56:47<11:55, 143.00s/it]
 83%|████████▎ | 24/29 [56:52<11:55, 143.03s/it]
 83%|████████▎ | 24/29 [57:02<11:56, 143.38s/it]
 83%|████████▎ | 24/29 [57:02<11:57, 143.48s/it]
 86%|████████▌ | 25/29 [59:18<09:40, 145.22s/it]
 86%|████████▌ | 25/29 [59:22<09:40, 145.20s/it]
 86%|████████▌ | 25/29 [59:32<09:41, 145.39s/it]
 86%|████████▌ | 25/29 [59:32<09:42, 145.51s/it]
 90%|████████▉ | 26/29 [1:01:15<06:50, 136.69s/it]
 90%|████████▉ | 26/29 [1:01:19<06:49, 136.65s/it]
 90%|████████▉ | 26/29 [1:01:28<06:49, 136.63s/it]
 90%|████████▉ | 26/29 [1:01:28<06:50, 136.72s/it]
 93%|█████████▎| 27/29 [1:03:04<04:16, 128.39s/it]
 93%|█████████▎| 27/29 [1:03:07<04:16, 128.29s/it]
 93%|█████████▎| 27/29 [1:03:17<04:16, 128.45s/it]
 93%|█████████▎| 27/29 [1:03:17<04:16, 128.48s/it]
 97%|█████████▋| 28/29 [1:05:15<02:09, 129.34s/it]
 97%|█████████▋| 28/29 [1:05:18<02:08, 128.89s/it]
 97%|█████████▋| 28/29 [1:05:27<02:08, 128.86s/it]
 97%|█████████▋| 28/29 [1:05:27<02:08, 128.98s/it]
100%|██████████| 29/29 [1:07:46<00:00, 135.73s/it]
100%|██████████| 29/29 [1:07:49<00:00, 135.53s/it]
100%|██████████| 29/29 [1:07:58<00:00, 135.61s/it]
100%|██████████| 29/29 [1:07:59<00:00, 135.75s/it]
30it [1:09:01, 117.58s/it]                        
30it [1:09:01, 138.05s/it]

30it [1:09:04, 117.36s/it]                        
30it [1:09:04, 138.14s/it]

30it [1:09:12, 116.94s/it]                        
30it [1:09:12, 138.41s/it]

30it [1:09:12, 116.99s/it]                        
30it [1:09:12, 138.42s/it]



srun --account=bbvz-delta-gpu \
python -m torch.distributed.run --nproc_per_node=4 /u/choprahetarth/all_files/starcoder/external_evals/starcoder_finetuned_evaluation.py \
--base_model_name_or_path='bigcode/starcoderbase-1b' \
--peft_model_path='//projects/bbvz/choprahetarth/new_experiments/experiment_1/final_checkpoint_starcoderbase-1b_lr_0.0001_bs_64_ms_54_dp_/u/choprahetarth/all_files/data/train_ftdata-new-small.json' \
--save='/scratch/bbvz/choprahetarth/experiment_1/fused_model' \
--batch_size=55